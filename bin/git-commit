#!/bin/sh
source "common.sh"

# Record changes to the repository

message="$1"

if [ ! "$message" ]; then
  message="Signed commit..."
  # message="$(basename $PWD)-$(date "+%Y.%m.%d-%H:%M:%S"): signed commit..."
  log_warn "Default message: '$message'"
fi

if ! git commit --all --gpg-sign="${ID_GPG_KEY}" --message "$message" >/dev/null 2>/dev/null; then
  log_error "An error occurred when record changes"
else
  log_success "Commit id $COLOR_BLUE'$(git rev-parse --short HEAD)'"
fi

git-push

#read -r -p "Push to the repository? [y/N]" git_push
#
#if [[ "$git_push" =~ ^([yY][eE][sS]|[yY])$ ]]; then
#  if ! git push origin --follow-tags >/dev/null 2>/dev/null; then
#    log_warn "An error occurred when pushing tag: $tag_name"
#  fi
#fi
