#!/bin/bash

function output {
  local text="${1:-}"
  # local text_color="${color_reset}"

  local label="${2:-}"
  local label_color

  local logger_priority="user.info"

  case "${label}" in
  "debug")
    label_color="${text_half}$(tput setaf 8)"
    logger_priority='user.debug'
    ;;
  "success")
    label_color="${text_half}${color_green}"
    logger_priority='user.success'
    ;;
  "info")
    label_color="${text_half}${color_blue}"
    logger_priority='user.info'
    ;;
  "notice" | "alert")
    label_color="${text_half}${color_blue}"
    logger_priority='user.notice'
    ;;
  "warning")
    label_color="${text_half}${color_yellow}"
    logger_priority='user.warn'
    ;;
  "error")
    label_color="${text_half}${color_red}"
    logger_priority='user.error'
    ;;
  *)
    unset label
    ;;
  esac

  local script_name
  script_name="$(basename "${0}")"
  script_name="${script_name%.*}"

  logger -tag "${script_name}" -logger_priority "${logger_priority}" "${text}"

  if [ "${label}" == "debug" ]; then
    return
  fi

  if [ -n "${label}" ]; then
    label="${label_color}[${label}]: "
  fi

  sleep .1
  printf "${color_reset}%s${color_reset}%s${color_reset}\n" "${label}" "${text}" >&2
}

function error_exit() {
  output "$1" "error" >&2
  exit 1
}

#output 'Debug message...' 'debug'
#output "Success message..." "success"
